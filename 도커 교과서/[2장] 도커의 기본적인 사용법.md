# 2.1 컨테이너로 Hello World 실행하기

```c
hee@yuhuijin-ui-MacBookAir hello-diamol % docker container run diamol/ch02-hello-diamol
Unable to find image 'diamol/ch02-hello-diamol:latest' locally
latest: Pulling from diamol/ch02-hello-diamol
941f399634ec: Pull complete 
93931504196e: Pull complete 
d7b1f3678981: Pull complete 
Digest: sha256:c4f45e04025d10d14d7a96df2242753b925e5c175c3bea9112f93bf9c55d4474
Status: Downloaded newer image for diamol/ch02-hello-diamol:latest
---------------------
Hello from Chapter 2!
---------------------
My name is:    # 컴퓨터의 이름
91cc19465791
---------------------
Im running on:
Linux 5.15.49-linuxkit aarch64     # 운영체제 종류
---------------------
My address is:     # 네트워크 주소
inet addr:172.17.0.2 Bcast:172.17.255.255 Mask:255.255.0.0
---------------------
```

`docker container run` **명령은 컨테이너로 애플리케이션을 실행하라는 도커 명령이다.** 이 애플리케이션은 미리 도커로 실행하도록 패키징돼 누구나 내려받을 수 있도록 공유된 것이다. 이 컨테이너 패키지(도커에서는 이를 ‘이미지’라고 한다)의 이름은 `diamol/ch02-hello-diamol` 이다. 그리고 지금 입력한 명령이 이미지를 이용해 컨테이너를 실행하는 도커 명령이다.

이미지를 이용해 컨테이너를 실행하려면 먼저 이미지가 있어야 한다. 조금 전의 명령을 처음 실행했던 시점에는 우리가 이미지를 갖고 있지 않았다. 그래서 출력 메시지 처음 부분에 unable to find image locally라는 메시지가 출력된 것이다. 그리고 이어서 도커가 이미지를 내려받는(도커에서 이미지를 내려받는 것을 pull이라고 한다)과정을 볼 수 있다.

이미지를 내려받고 나면 내려받은 이미지를 사용해 컨테이너를 실행한다. 이미지에는 애플리케이션을 실행하는데 필요한 모든 내용과 함께 애플리케이션을 실행하는 방법이 정의돼 있다.

아주 간단한 애플리케이션이지만 이 과정에서 도커를 사용하는 워크플로의 핵심을 볼 수 있다. 먼저 애플리케이션을 컨테이너에서 실행할 수 있도록 패키징하고, 다른 사람이 패키지를 사용할 수 있도록 공유한 다음, 이 패키지를 내려받은 사람이 컨테이너를 통해 애플리케이션을 실행하는 것이다. 도커에서는 이 과정을 빌드, 공유, 실행이라고 부른다.

빌드, 공유, 실행은 매우 강력한 개념이다. 아무리 복잡한 애플리케이션이라도 모두 이 과정을 거치기 때문이다. 그리고 도커를 실행할 수 있는 환경이라면 어디서든 실행할 수 있도록 도커 이미지를 만들 수 있다. 이런 방법으로 도커의 핵심적인 이점인 이식성이 확보된다.

```c
hee@yuhuijin-ui-MacBookAir hello-diamol % docker container run diamol/ch02-hello-diamol
---------------------
Hello from Chapter 2!
---------------------
My name is:
476c9a32660a
---------------------
Im running on:
Linux 5.15.49-linuxkit aarch64
---------------------
My address is:
inet addr:172.17.0.2 Bcast:172.17.255.255 Mask:255.255.0.0
```

같은 명령을 한번 더 입력해 또 다른 컨테이너를 실행하면 어떻게 될까? 아까와 비슷하지만 조금 다른 내용이 출력된다. 도커가 조금 전 이미지를 이미 내려받았기 때문에 이미지를 내려받는 부분이 사라지고 바로 컨테이너를 실행하는 메시지가 출력된다. 같은 컴퓨터를 사용하므로 컨테이너가 출력하는 내용 중 운영체제와 아키텍처에 대한 내용은 아까와 같으며, 컴퓨터 이름과 네트워크 주소에 대한 내용은 달라진다.

컴퓨터 이름은 컨테이너를 실행할 때마다 매번 바뀌며, IP 주소 역시 매번 바뀔 확률이 높다. 그런데 모든 컨테이너는 같은 컴퓨터에서 실행될텐데 컴퓨터 이름과 IP 주소가 왜 계속 바뀌는 것일까?

# 2.2 컨테이너란 무엇인가?

도커 컨테이너는 말 그대로 물건을 담는 컨테이너와 다를 것이 없다. 애플리케이션이 들어 있는 어떤 상자를 상상해보자. 이 상자 안에는 애플리케이션과 애플리케이션을 실행할 컴퓨터가 함께 들어있다.

호스트명, IP 주소, 파일 시스템까지 이들은 모두 도커가 만들어낸 가상 리소스다. 이들이 서로 엮여 애플리케이션이 동작할 수 있는 환경이 만들어진다. 이 환경이 바로 그림 2-2의 ‘상자’다. 상자 안에서는 상자 밖의 환경을 볼 수 없다. 그러나 이 상자는 어떤 컴퓨터상에서 동작하는 것이고, 이 컴퓨터는 이 상자 말고도 다른 상자를 여러개 실행할 수 있다. 이들 상자는 서로 독립적인 환경을 갖지만 상자가 실행되는 컴퓨터의 CPU와 메모리, 운영체제를 공유한다.

이러한 구도가 중요한 이유는 **격리와 밀집이라는 얼핏 보면 모순돼보이는 조건을 동시에 만족할 수 있기 때문이다.** **밀집이란 컴퓨터에 CPU와 메모리가 허용하는 한 되도록 많은 수의 애플리케이션을 실행하는 것을 의미**한다. 그러나 서로 다른 여러 애플리케이션을 동시에 실행하는 데는 제약이 따른다. 자바나 닷넷 등 필요로하는 런타임의 버전이 서로 다를 수도 있고, 서로 호환되지 않는 버전의 라이브러리를 사용하는가 하면, 어느 한 애플리케이션이 과다한 리소스를 필요로 해 다른 애플리케이션의 리소스가 부족해질 수도 있다. 이런 면을 고려하면 **애플리케이션은 서로 독립된 환경에서 실행돼야 한다.** 하지만 그럴 경우 한 컴퓨터에서 여러 애플리케이션을 실행할 수 없게 되고, 다시 말해 밀집을 달성할 수 없다.

이 모순된 조건을 동시 달성하려던 첫 번째 시도는 가상 머신을 사용하는 것이었다. 가상 머신은 애플리케이션이 실행될 독립적 환경이 생긴다는 점에서는 컨테이너와 큰 차이가 없다. **다만 가상 머신은 컨테이너와 달리 호스트 컴퓨터의 운영체제를 공유하지 않고 별도의 운영체제를 필요로 한다.** 각각의 가상머신은 자신만의 운영체제를 별도로 갖는다. 이 운영체제는 애플리케이션이 사용해야 할 CPU와 메모리 자원을 상당량 차지한다. 운영체제의 라이선스 비용과 운영체제 업데이트 설치 부담이 추가로 생긴다. 결국 **가상 머신은 격리는 달성할 수 있지만 밀집은 제공하지 못한다.**

컨테이너는 이러한 단점을 해결할 수 있다. 각각의 컨테이너는 호스트 컴퓨터의 운영체제를 공유하므로 필요한 리소스가 크게 경감된다. 그만큼 실행도 빠르고 같은 호스트 컴퓨터에서 가상 머신에 비해 더 많은 수의 애플리케이션을 실행할 수 있다. 또한, 컨테이너 역시 외부와 독립된 환경을 제공하므로 밀집과 격리가 동시에 달성되는 것이다. 이것이 도커의 또 다른 특징인 효율성이다.

# 2.3 컨테이너를 원격 컴퓨터처럼 사용하기

도커를 사용하면 도구와 스크립트를 하나의 이미지로 패키징해 추가적인 설치나 설정 작업 없이 컨테이너로 스크립트를 바로 실행하게 할 수 있다.

이번에는 컨테이너를 실행하고, 실행된 컨테이너에 마치 원격 컴퓨터에 접속하듯 터미널을 통해 접근해보겠다. 

```c
hee@yuhuijin-ui-MacBookAir hello-diamol % docker run --interactive --tty diamol/base
Unable to find image 'diamol/base:latest' locally
latest: Pulling from diamol/base
941f399634ec: Already exists 
716aca3e500c: Pull complete 
Digest: sha256:787fe221a14f46b55e224ea0436aca77d345c3ded400aaf6cd40125e247f35c7
Status: Downloaded newer image for diamol/base:latest
/ # 

/ # hostname
9b0083306cbd
/ # date
Sat Dec 27 11:50:00 UTC 2025
```

`--interactive` 플래그를 사용하면 컨테이너에 접속된 상태가 된다. 그리고 `--tty` 플래그는 터미널 세션을 통해 컨테이너를 조작하겠다는 의미이다.

원격 컴퓨터에 접속한 것과 같은 로컬 터미널 세션이 열려 있다는 것과 연결된 컴퓨터가 현재 실행 중인 컨테이너라는 것이다. 이를테면 보안 셸(ssh)을 통해 원격 리눅스 컴퓨터에 연결하거나 원격 데스크톱을 통해 다른 윈도 컴퓨터에 연결했다면 지금 컨테이너에 연결한 것과 같은 결과를 얻게 된다.

도커 컨테이너는 호스트 컴퓨터의 운영체제를 공유한다. 그렇기 때문에 호스트 컴퓨터가 리눅스 머신이면 리눅스 셸이 뜨고, 윈도 머신이라면 윈도 명령 프롬프트가 뜨는 것이다.

도커 자체는 호스트 컴퓨터의 아키텍처나 운영체제와 상관없이 동일하게 동작하지만, 컨테이너에 들어 있는 애플리케이션은 운영체제나 아키텍처를 가릴 수 있다. 결국 컨테이너의 내용물이 무엇이든 컨테이너를 다루는 방법은 환경과 상관없이 동일하다.